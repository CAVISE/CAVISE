services:
  artery_cavise:
    image: $NEXUS_ADDR/$ARTERY_IMAGE:$TAG
    privileged: true
    environment:
      - DISPLAY=${DISPLAY}
    volumes:
      - /usr/share/vulkan/icd.d:/usr/share/vulkan/icd.d
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ./cavise/messages:/cavise/messages
      - ./protos:/cavise/protos
      - ./simdata:/cavise/simdata
      - ./artery:/cavise/artery
    command: ["sh", "-c", "sleep infinity"]    
    healthcheck:
      test: ["CMD", "ping", "-c", "1", "opencda_cavise"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    networks:
      - cccp_network

  opencda_cavise:
    image: $NEXUS_ADDR/$OPENCDA_IMAGE:$TAG
    privileged: true
    environment:
      - DISPLAY=${DISPLAY}
    volumes:
      - /usr/share/vulkan/icd.d:/usr/share/vulkan/icd.d
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ./cavise/messages:/cavise/messages
      - ./protos:/cavise/protos
      - ./simdata:/cavise/simdata
      - ./.python-version:/cavise/.python-version
      - ./opencda:/cavise/opencda
    command: ["sh", "-c", "sleep infinity"]
    healthcheck:
      test: ["CMD", "ping", "-c", "1", "artery_cavise"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    networks:
      - cccp_network

networks:
  cccp_network:
